# Ruby rand
rand: (n) ->
  Math.floor(Math.random()*n)

Array.prototype.pick: ->
  this[rand(@length)]

Art: {
  width: 960,
  height: 1280,
  visibleWidth: 700
  visibleHeight: 320
  works: []
  colors: ['#FFFFFF', '#9900CC', '#0066CC', '#FFFF00', '#33CC99', '#FF6633']
  draw: (paper) ->
    focus: {
      x: (@width-@visibleWidth)*0.5 + rand(@visibleWidth)
      y: (@height-@visibleHeight)*0.5 + rand(@visibleHeight)
    }
    for i in [0...4+rand(4)]
      @works[rand(@works.length)].call(paper, @colors.pick(), focus)

}

<% @artworks.each do |_,fn| %>
Art.works.push <%= fn %>
<% end %>

$(document).ready ->
  paper: Raphael 'art', Art.width, Art.height
  Art.draw paper

  reload: $('#frame a.reload')
  tee: $('#frame a.tee')

  reload.click ->
    $(paper.canvas).empty()
    Art.draw paper
    false
