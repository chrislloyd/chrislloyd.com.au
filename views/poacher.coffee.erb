alert 'foo'

# Ruby rand
rand: (n) ->
  Math.floor(Math.random()*n)

Array.prototype.pick: ->
  this[rand(@length)]

Art: {
  width: 960,
  height: 320,
  visibleWidth: 700
  visibleHeight: 320
  works: []
  colors: ['#FFFFFF', '#9900CC', '#0066CC', '#FFFF00', '#33CC99', '#FF6633']
  draw: (paper) ->
    paper.rect(0,0,@width,@height).attr({
      fill: @colors.pick()
      stroke: 'none'
      opacity: Math.random()
    }) if rand(5) == 0
    focus: {
      x: (@width-@visibleWidth)*0.5 + rand(@visibleWidth)
      y: (@height-@visibleHeight)*0.5 + rand(@visibleHeight)
    }
    for i in [0...4+rand(4)]
      @works[rand(@works.length)].call(paper, @colors.pick(), focus)
}

$(document).ready ->
  frame: $('#frame')
  paper: Raphael 'art', Art.width, Art.height
  canvas: $(paper.canvas)
  buy: $('#buy')
  canvas.css('marginTop', -(Art.height - frame.height()) * 0.5)
  Art.draw paper

  reload: frame.find('a.reload')

  reload.click ->
    canvas.empty()
    Art.draw paper
    false

  buy.click ->
    canvas.css('zoom', 0.5)
